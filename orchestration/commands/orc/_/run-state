## Run State Management

Generate unique run identifier:
```bash
RUN_ID=$(date +%Y-%m-%d-%H%M%S)
```

Write per-run state file at `.claude/run/$RUN_ID.json`:
```bash
echo '{"run_id":"'$RUN_ID'","type":"<SIMPLE|MEDIUM|COMPLEX>","base":null,"status":"<planning|awaiting|executing|completed|aborted>","lock":null,"args":"$ARGUMENTS","flags":{"base":"<branch-or-null>","confirm":<true|false>,"force_path":"<simple|medium|complex|null>"}}' > .claude/run/$RUN_ID.json
```

Update run state using jq:
```bash
jq '.status="executing" | .lock="locks/<target-branch>.lock" | .base="<base-branch>"' .claude/run/$RUN_ID.json > .claude/run/$RUN_ID.json.tmp && mv .claude/run/$RUN_ID.json.tmp .claude/run/$RUN_ID.json
```

Update current state (for hook consumption):
```bash
echo '{"type":"<SIMPLE|MEDIUM|COMPLEX>","base":"<base-branch>","status":"<planning|executing|completed|aborted>"}' > .claude/run/current.json
```
